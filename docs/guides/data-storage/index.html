<!doctype html>
<html class="docs-version-2.0.6" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<link rel="search" type="application/opensearchdescription+xml" title="Apify SDK" href="/apify-ts/opensearch.xml"><title data-react-helmet="true">Data Storage | Apify SDK</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://apify.github.io/apify-ts/img/apify_og_SDK.png"><meta data-react-helmet="true" name="twitter:image" content="https://apify.github.io/apify-ts/img/apify_og_SDK.png"><meta data-react-helmet="true" property="og:url" content="https://apify.github.io/apify-ts/docs/guides/data-storage"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="2.0.6"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-2.0.6"><meta data-react-helmet="true" property="og:title" content="Data Storage | Apify SDK"><meta data-react-helmet="true" name="description" content="The Apify SDK has several data storage types that are useful for specific tasks. The data is stored either on local disk to a directory defined by the"><meta data-react-helmet="true" property="og:description" content="The Apify SDK has several data storage types that are useful for specific tasks. The data is stored either on local disk to a directory defined by the"><link data-react-helmet="true" rel="shortcut icon" href="/apify-ts/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://apify.github.io/apify-ts/docs/guides/data-storage"><link data-react-helmet="true" rel="alternate" href="https://apify.github.io/apify-ts/docs/guides/data-storage" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://apify.github.io/apify-ts/docs/guides/data-storage" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/apify-ts/assets/css/styles.a98ee9e8.css">
<link rel="preload" href="/apify-ts/assets/js/runtime~main.b1dbc8ba.js" as="script">
<link rel="preload" href="/apify-ts/assets/js/main.a9553a22.js" as="script">
</head>
<body>
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/apify-ts/"><div class="navbar__logo"><img src="/apify-ts/img/apify_logo.svg" alt="Apify SDK" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/apify-ts/img/apify_logo.svg" alt="Apify SDK" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">Apify SDK</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/apify-ts/docs/">Guide</a><a class="navbar__item navbar__link" href="/apify-ts/docs/examples/crawl-multiple-urls">Examples</a><a class="navbar__item navbar__link" href="/apify-ts/api">API Reference</a><a href="https://github.com/apify/apify-js" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable"><a aria-current="page" class="navbar__link" href="/apify-ts/docs/">2.0.6</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/apify-ts/docs/next/">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/apify-ts/docs/guides/data-storage">2.0.6</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->2.0.6</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Data Storage</h1></header><p>The Apify SDK has several data storage types that are useful for specific tasks. The data is stored either on local disk to a directory defined by the
<code>APIFY_LOCAL_STORAGE_DIR</code> environment variable, or on the <a href="/apify-ts/docs/guides/apify-platform">Apify platform</a> under the user account
identified by the API token defined by the <code>APIFY_TOKEN</code> environment variable. If neither of these variables is defined, by default Apify SDK sets
<code>APIFY_LOCAL_STORAGE_DIR</code> to <code>./apify_storage</code> in the current working directory and prints a warning.</p><p>Typically, you will be developing the code on your local computer and thus set the <code>APIFY_LOCAL_STORAGE_DIR</code> environment variable. Once the code is
ready, you will deploy it to the Apify platform, where it will automatically set the <code>APIFY_TOKEN</code> environment variable and thus use cloud storage. No
code changes are needed.</p><p><strong>Related links</strong></p><ul><li><a href="https://docs.apify.com/storage" target="_blank" rel="noopener">Apify platform storage documentation</a></li><li><a href="https://my.apify.com/storage" target="_blank" rel="noopener">View storage in Apify app</a></li><li><a href="https://apify.com/docs/api/v2#/reference/key-value-stores" target="_blank" rel="noopener">API reference</a></li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="key-value-store">Key-value store<a aria-hidden="true" class="hash-link" href="#key-value-store" title="Direct link to heading">â€‹</a></h2><p>The key-value store is used for saving and reading data records or files. Each data record is represented by a unique key and associated with a MIME
content type. Key-value stores are ideal for saving screenshots of web pages, PDFs or to persist the state of crawlers.</p><p>Each actor run is associated with a <strong>default key-value store</strong>, which is created exclusively for the actor run. By convention, the actor run input
and output is stored in the default key-value store under the <code>INPUT</code> and <code>OUTPUT</code> key, respectively. Typically the input and output is a JSON file,
although it can be any other format.</p><p>In the Apify SDK, the key-value store is represented by the <a href="/apify-ts/docs/api/key-value-store"><code>KeyValueStore</code></a> class. In order to simplify access to the default
key-value store, the SDK also provides <a href="/apify-ts/docs/api/apify#getvalue"><code>Apify.getValue()</code></a> and
<a href="/apify-ts/docs/api/apify#setvalue"><code>Apify.setValue()</code></a> functions.</p><p>In local configuration, the data is stored in the directory specified by the <code>APIFY_LOCAL_STORAGE_DIR</code> environment variable as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">APIFY_LOCAL_STORAGE_DIR</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token operator" style="color:#063289">/</span><span class="token plain">key_value_stores</span><span class="token operator" style="color:#063289">/</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">STORE_ID</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token operator" style="color:#063289">/</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">KEY</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">EXT</span><span class="token punctuation" style="color:#b6ad9a">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that <code>{STORE_ID}</code> is the name or ID of the key-value store. The default key value store has ID <code>default</code>, unless you override it by setting the
<code>APIFY_DEFAULT_KEY_VALUE_STORE_ID</code> environment variable. The <code>{KEY}</code> is the key of the record and <code>{EXT}</code> corresponds to the MIME content type of the
data value.</p><p>The following code demonstrates basic operations of key-value stores:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#728fcb"><span class="token comment" style="color:#b6ad9a">// Get actor input from the default key-value store</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> input </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> </span><span class="token maybe-class-name">Apify</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">getInput</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Write actor output to the default key-value store.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> </span><span class="token maybe-class-name">Apify</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">setValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&#x27;OUTPUT&#x27;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> myResult</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token number" style="color:#063289">123</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Open a named key-value store</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> store </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> </span><span class="token maybe-class-name">Apify</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">openKeyValueStore</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&#x27;some-name&#x27;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Write record. JavaScript object is automatically converted to JSON,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// strings and binary buffers are stored as they are</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> store</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">setValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&#x27;some-key&#x27;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> foo</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&#x27;bar&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Read record. Note that JSON is automatically parsed to a JavaScript object,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// text data returned as a string and other data is returned as binary buffer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> value </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> store</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">getValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&#x27;some-key&#x27;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Delete record</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> store</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">setValue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&#x27;some-key&#x27;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#728fcb">null</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To see a real-world example of how to get the input from the key-value store, see the <a href="/apify-ts/docs/examples/screenshots">Screenshots</a> example.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="dataset">Dataset<a aria-hidden="true" class="hash-link" href="#dataset" title="Direct link to heading">â€‹</a></h2><p>Datasets are used to store structured data where each object stored has the same attributes, such as online store products or real estate offers. You
can imagine a dataset as a table, where each object is a row and its attributes are columns. Dataset is an append-only storage - you can only add new
records to it but you cannot modify or remove existing records.</p><p>When the dataset is stored on the <a href="/apify-ts/docs/guides/apify-platform">Apify platform</a>, you can export its data to the following formats: HTML,
JSON, CSV, Excel, XML and RSS. The datasets are displayed on the actor run details page and in the
<a href="https://my.apify.com/storage" target="_blank" rel="noopener">Storage</a> section in the Apify app. The actual data is exported using the
<a href="https://apify.com/docs/api/v2#/reference/datasets/item-collection/get-items" target="_blank" rel="noopener">Get dataset items</a> Apify API endpoint. This
way you can easily share crawling results.</p><p>Each actor run is associated with a <strong>default dataset</strong>, which is created exclusively for the actor run. Typically, it is used to store crawling
results specific for the actor run. Its usage is optional.</p><p>In the Apify SDK, the dataset is represented by the <a href="/apify-ts/docs/api/dataset"><code>Dataset</code></a> class. In order to simplify writes to the default dataset, the SDK
also provides the <a href="/apify-ts/docs/api/apify#pushdata"><code>Apify.pushData()</code></a> function.</p><p>In local configuration, the data is stored in the directory specified by the <code>APIFY_LOCAL_STORAGE_DIR</code> environment variable as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">APIFY_LOCAL_STORAGE_DIR</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token operator" style="color:#063289">/</span><span class="token plain">datasets</span><span class="token operator" style="color:#063289">/</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">DATASET_ID</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token operator" style="color:#063289">/</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">INDEX</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token property-access">json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that <code>{DATASET_ID}</code> is the name or ID of the dataset. The default dataset has ID <code>default</code>, unless you override it by setting the
<code>APIFY_DEFAULT_DATASET_ID</code> environment variable. Each dataset item is stored as a separate JSON file, where <code>{INDEX}</code> is a zero-based index of the
item in the dataset.</p><p>The following code demonstrates basic operations of the dataset:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#728fcb"><span class="token comment" style="color:#b6ad9a">// Write a single row to the default dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> </span><span class="token maybe-class-name">Apify</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">pushData</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> col1</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token number" style="color:#063289">123</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> col2</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&#x27;val2&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Open a named dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> dataset </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> </span><span class="token maybe-class-name">Apify</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">openDataset</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&#x27;some-name&#x27;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Write a single row</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">pushData</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> foo</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&#x27;bar&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Write multiple rows</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> dataset</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">pushData</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">[</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> foo</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&#x27;bar2&#x27;</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> col2</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&#x27;val2&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> col3</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token number" style="color:#063289">123</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">]</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To see how to use the dataset to store crawler results, see the <a href="/apify-ts/docs/examples/cheerio-crawler">Cheerio Crawler</a> example.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="request-queue">Request queue<a aria-hidden="true" class="hash-link" href="#request-queue" title="Direct link to heading">â€‹</a></h2><p>The request queue is a storage of URLs to crawl. The queue is used for the deep crawling of websites, where you start with several URLs and then
recursively follow links to other pages. The data structure supports both breadth-first and depth-first crawling orders.</p><p>Each actor run is associated with a <strong>default request queue</strong>, which is created exclusively for the actor run. Typically, it is used to store URLs to
crawl in the specific actor run. Its usage is optional.</p><p>In Apify SDK, the request queue is represented by the <a href="/apify-ts/docs/api/request-queue"><code>RequestQueue</code></a> class.</p><p>In local configuration, the request queue data is stored in the directory specified by the <code>APIFY_LOCAL_STORAGE_DIR</code> environment variable as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#728fcb"><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">APIFY_LOCAL_STORAGE_DIR</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token operator" style="color:#063289">/</span><span class="token plain">request_queues</span><span class="token operator" style="color:#063289">/</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">QUEUE_ID</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token operator" style="color:#063289">/</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">STATE</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token operator" style="color:#063289">/</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token constant">NUMBER</span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token property-access">json</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that <code>{QUEUE_ID}</code> is the name or ID of the request queue. The default queue has ID <code>default</code>, unless you override it by setting the
<code>APIFY_DEFAULT_REQUEST_QUEUE_ID</code> environment variable. Each request in the queue is stored as a separate JSON file, where <code>{STATE}</code> is either
<code>handled</code> or <code>pending</code>, and <code>{NUMBER}</code> is an integer indicating the position of the request in the queue.</p><p>The following code demonstrates basic operations of the request queue:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly javascript"><pre tabindex="0" class="prism-code language-javascript codeBlock_23N8 thin-scrollbar" style="background-color:#faf8f5;color:#728fcb"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#728fcb"><span class="token comment" style="color:#b6ad9a">// Open the default request queue associated with the actor run</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> queue </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> </span><span class="token maybe-class-name">Apify</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">openRequestQueue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Open a named request queue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> queueWithName </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> </span><span class="token maybe-class-name">Apify</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">openRequestQueue</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token string" style="color:#728fcb">&#x27;some-name&#x27;</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Enqueue few requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">addRequest</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> url</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&#x27;http://example.com/aaa&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">addRequest</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> url</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&#x27;http://example.com/bbb&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">addRequest</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> url</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token string" style="color:#728fcb">&#x27;http://example.com/foo/bar&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">{</span><span class="token plain"> forefront</span><span class="token operator" style="color:#063289">:</span><span class="token plain"> </span><span class="token boolean" style="color:#728fcb">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#b6ad9a">}</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Get requests from queue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> request1 </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">fetchNextRequest</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> request2 </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">fetchNextRequest</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword" style="color:#728fcb">const</span><span class="token plain"> request3 </span><span class="token operator" style="color:#063289">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">fetchNextRequest</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// Mark a request as handled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">markRequestHandled</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">request1</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token comment" style="color:#b6ad9a">// If processing fails then reclaim the request back to the queue, so that it&#x27;s crawled again</span><span class="token plain"></span><br></span><span class="token-line" style="color:#728fcb"><span class="token plain"></span><span class="token keyword control-flow" style="color:#728fcb">await</span><span class="token plain"> queue</span><span class="token punctuation" style="color:#b6ad9a">.</span><span class="token method function property-access" style="color:#b29762">reclaimRequest</span><span class="token punctuation" style="color:#b6ad9a">(</span><span class="token plain">request2</span><span class="token punctuation" style="color:#b6ad9a">)</span><span class="token punctuation" style="color:#b6ad9a">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To see how to use the request queue with a crawler, see the <a href="/apify-ts/docs/examples/puppeteer-crawler">Puppeteer Crawler</a> example.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_13-_"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2021-11-04T14:36:40.000Z">11/4/2021</time></b> by <b>Martin AdÃ¡mek</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#key-value-store" class="table-of-contents__link toc-highlight">Key-value store</a></li><li><a href="#dataset" class="table-of-contents__link toc-highlight">Dataset</a></li><li><a href="#request-queue" class="table-of-contents__link toc-highlight">Request queue</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/apify-ts/docs/">Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/apify-ts/docs/examples/crawl-multiple-urls">Examples</a></li><li class="footer__item"><a class="footer__link-item" href="/apify-ts/docs/api/apify">API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/apify" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/apify" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.facebook.com/apifytech" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://apify.com" target="_blank" class="footer__link-item">
        <span>
            Apify Cloud
            <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" style="margin-left: 0.3rem; position: relative; top: 1px;">
                <path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z">
                </path>
            </svg>
        </span>
    </a></li><li class="footer__item"><a href="https://docusaurus.io" target="_blank" class="footer__link-item">
        <span>
            Docusaurus
            <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" style="margin-left: 0.3rem; position: relative; top: 1px;">
                <path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z">
                </path>
            </svg>
        </span>
    </a></li><li class="footer__item"><a href="https://github.com/apify/apify-js" target="_blank" class="footer__link-item">
        <span>
            GitHub
            <svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" style="margin-left: 0.3rem; position: relative; top: 1px;">
                <path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z">
                </path>
            </svg>
        </span>
    </a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_MyFc" href="/apify-ts/"><img src="/apify-ts/img/apify_logo.svg" alt="" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/apify-ts/img/apify_logo.svg" alt="" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2021 Apify Technologies s.r.o.</div></div></div></footer></div>
<script src="/apify-ts/assets/js/runtime~main.b1dbc8ba.js"></script>
<script src="/apify-ts/assets/js/main.a9553a22.js"></script>
</body>
</html>