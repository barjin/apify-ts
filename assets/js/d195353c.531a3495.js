"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3728],{4633:(e,t,a)=>{a.d(t,{Z:()=>o});var n=a(7294),s=a(3725),r=a(2263);const o=function(e){var t=e.apiPath,a=e.children,o=(0,s.useDocsVersion)(),p=(0,r.default)().siteConfig;return n.createElement("a",{href:p.baseUrl+"api/"+("current"===o.version?"next":o.version)+"/"+t},a)}},7080:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>u,default:()=>w,frontMatter:()=>i,metadata:()=>c,toc:()=>h});var n=a(7462),s=a(3366),r=(a(7294),a(3905)),o=a(1736),p=a(4633);var l=["components"],i={id:"use-stealth-mode",title:"Use stealth mode"},u=void 0,c={unversionedId:"examples/crawlers/puppeteer/use-stealth-mode",id:"examples/crawlers/puppeteer/use-stealth-mode",title:"Use stealth mode",description:"Stealth mode allows you to bypass anti-scraping techniques that use",source:"@site/../docs/examples/crawlers/puppeteer/use_stealth_mode.mdx",sourceDirName:"examples/crawlers/puppeteer",slug:"/examples/crawlers/puppeteer/use-stealth-mode",permalink:"/apify-ts/docs/next/examples/crawlers/puppeteer/use-stealth-mode",tags:[],version:"current",lastUpdatedBy:"Vlad Frangu",lastUpdatedAt:1646754541,formattedLastUpdatedAt:"3/8/2022",frontMatter:{id:"use-stealth-mode",title:"Use stealth mode"},sidebar:"docs",previous:{title:"Synchronous run",permalink:"/apify-ts/docs/next/examples/crawlers/puppeteer/synchronous-run"}},d={},h=[{value:"Single-browser instances",id:"single-browser-instances",level:3}],m={toc:h};function w(e){var t=e.components,a=(0,s.Z)(e,l);return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Stealth mode allows you to bypass anti-scraping techniques that use\n",(0,r.kt)("a",{parentName:"p",href:"https://pixelprivacy.com/resources/browser-fingerprinting/",target:"_blank",rel:"noopener"},"browser fingerprinting"),". It overrides the attributes specified for\n",(0,r.kt)("a",{parentName:"p",href:"https://developers.google.com/web/updates/2017/04/headless-chrome",target:"_blank",rel:"noopener"},"headless")," browser mode, making your headless browser harder to distinguish from\nthe full Chrome browser."),(0,r.kt)("p",null,"To activate stealth mode, you need to turn ",(0,r.kt)("inlineCode",{parentName:"p"},"useChrome")," on, run ",(0,r.kt)("inlineCode",{parentName:"p"},"headless")," and turn ",(0,r.kt)("inlineCode",{parentName:"p"},"stealth")," on in your ",(0,r.kt)(p.Z,{apiPath:"puppeteer-crawler/interface/PuppeteerCrawlerOptions#launchContext",mdxType:"VersionedApiLink"},(0,r.kt)("inlineCode",{parentName:"p"},"launchContext")),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const launchContext = {\n    useChrome: true,\n    stealth: true,\n    launchOptions: {\n        headless: true,\n    },\n};\n")),(0,r.kt)(o.Z,{className:"language-js",mdxType:"CodeBlock"},"import { Dataset, PuppeteerCrawler } from '@crawlers/puppeteer';\n\nconst dataset = await Dataset.open();\n\nconst crawler = new PuppeteerCrawler({\n    launchContext: {\n        useChrome: true,\n        stealth: true,\n        launchOptions: {\n            headless: true,\n        },\n        // You can override default stealth options\n        // stealthOptions: {\n        //     addLanguage: false,\n        // },\n    },\n    async requestHandler({ page }) {\n        const data = await page.$$eval('.athing', ($posts) => {\n            const scrapedData = [];\n            // Get the title of each post on Hacker News\n            $posts.forEach(($post) => {\n                const title = $post.querySelector('.title a').innerText;\n                scrapedData.push({\n                    title: `The title is: ${title}`,\n                });\n            });\n            return scrapedData;\n        });\n            // Save the data array to the Apify dataSet\n        await dataset.pushData(data);\n    },\n});\n\nawait crawler.addRequests(['https://news.ycombinator.com/']);\n\nawait crawler.run();\n"),(0,r.kt)("p",null,"You can then specify the ",(0,r.kt)(p.Z,{apiPath:"puppeteer-crawler/namespace/puppeteerStealth#StealthOptions",mdxType:"VersionedApiLink"},(0,r.kt)("inlineCode",{parentName:"p"},"stealthOptions"))," you want,\nwhich allow you to adapt to different anti-scraping techniques. All the options are set to ",(0,r.kt)("inlineCode",{parentName:"p"},"true")," by default. The number of options does not affect performance."),(0,r.kt)("p",null,"While the default configuration will be fine in many cases, you can adapt the options to your use case."),(0,r.kt)("h3",{id:"single-browser-instances"},"Single-browser instances"),(0,r.kt)("p",null,"You can also use stealth mode in single-browser instances when using ",(0,r.kt)(p.Z,{apiPath:"puppeteer-crawler/function/launchPuppeteer",mdxType:"VersionedApiLink"},(0,r.kt)("inlineCode",{parentName:"p"},"launchPuppeteer")),".\nThe ",(0,r.kt)("inlineCode",{parentName:"p"},"launchContext")," is the same."))}w.isMDXComponent=!0}}]);